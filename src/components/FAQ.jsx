// FAQ.js
import React, { useState, useEffect, useRef } from 'react';

const FAQ = ({ targetUser }) => {
  const [activeIndex, setActiveIndex] = useState(null);
  const faqRef = useRef(null);

  useEffect(() => {
    const observer = new IntersectionObserver(
      (entries) => {
        const [entry] = entries;
        if (entry.isIntersecting) {
          const items = faqRef.current.querySelectorAll('.faq-item');
          items.forEach((item, index) => {
            setTimeout(() => {
              item.classList.add('animate');
            }, index * 100);
          });
        }
      },
      {
        root: null,
        threshold: 0.1,
      }
    );

    if (faqRef.current) {
      observer.observe(faqRef.current);
    }

    return () => {
      if (faqRef.current) {
        observer.unobserve(faqRef.current);
      }
    };
  }, []);

  const toggleFAQ = (index) => {
    setActiveIndex(activeIndex === index ? null : index);
  };

  const getFAQs = () => {
    switch (targetUser) {
      case 'intermediate':
        return [
          {
            question: '初心者用セットからの買い替え時期はいつ頃ですか？',
            answer: '使用頻度にもよりますが、一般的には週1回以上使用している場合は約1年、月1～2回程度の使用なら2～3年が買い替えの目安となります。特に、マスクの締め付けが緩む、フィンの推進力が弱まる、スノーケルのバルブの反応が悪くなるなどの症状が出た場合は、アップグレードを検討するタイミングです。'
          },
          {
            question: 'アップグレードセットで得られる主なメリットは？',
            answer: '主に3つのメリットがあります。1つ目は「快適性の向上」で、長時間使用しても疲れにくくなります。2つ目は「パフォーマンスの向上」で、特にフィンの推進力が増し、潜水時間や距離が伸びます。3つ目は「耐久性の向上」で、頻繁な使用にも耐える高品質素材が使われているため、長期間性能を維持します。'
          },
          {
            question: '個別に買うのとセットで買うのではどちらがお得ですか？',
            answer: '同じ品質の商品を個別に購入すると、セット価格より15～20%ほど高くなる傾向があります。また、セットでは各パーツの相性が考慮されているため、最適な組み合わせで使用できるメリットもあります。さらに、当サイトのセットは保証期間も通常よりも長く設定されています。'
          },
          {
            question: '以前持っていた装備と組み合わせて使えますか？',
            answer: '基本的には可能ですが、特にマスクとスノーケルは一緒に使用することが多いため、セットで使うことをおすすめします。フィンは単体でアップグレードしても効果が高いですが、全体のバランスを考えると、同時期に製造された同じブランドの製品を使用する方が性能を最大限に発揮できます。'
          },
          {
            question: 'メンテナンス方法は初心者用と異なりますか？',
            answer: 'アップグレードセットには高品質素材や精密なパーツが使われているため、より丁寧なメンテナンスが必要です。特に使用後の真水でのすすぎはより念入りに行い、直射日光を避けて乾燥させてください。また、シリコン部分には専用の保護剤を定期的に使用することで、劣化を防ぎ長持ちさせることができます。'
          }
        ];
      case 'advanced':
        return [
          {
            question: '競技用と普段練習用の装備は分けるべきですか？',
            answer: 'プロレベルになると、用途に応じて装備を使い分けることをおすすめします。競技用は最高のパフォーマンスを発揮できる設計ですが、その分消耗も早くなります。日常練習用にはやや耐久性を重視したモデルを使用し、大会前の調整や本番でハイエンドモデルを使う方法が一般的です。当サイトのプロフェッショナルセットは両用途で使えるバランスの取れた設計になっています。'
          },
          {
            question: 'カスタマイズは可能ですか？',
            answer: 'はい、当サイトのプロフェッショナルセット以上のグレードではカスタマイズが可能です。特にフィンのブレード硬度や長さ、マスクの鼻部分の形状などを調整できます。ご注文時に備考欄にご希望をご記入いただくか、購入前にお問い合わせください。エリートアスリートモデルではさらに詳細なカスタマイズが可能で、事前の採寸なども行っています。'
          },
          {
            question: '世界大会レベルの競技で使用できますか？',
            answer: '当サイトのエリートアスリートモデルは、国際大会での使用実績があり、多くのトップ選手に愛用されています。すべての製品は国際水中スポーツ連盟（CMAS）の基準を満たしており、公式大会での使用が認められています。特にカーボンフィンは世界記録保持者も使用する最高品質のものを採用しています。'
          },
          {
            question: '極限環境での使用に耐えられますか？',
            answer: 'エリートモデルとプロフェッショナルモデルは、水温5℃～35℃、水深30mまでの使用を想定して設計されています。特に低水温環境では一般的なモデルよりも素材の柔軟性が維持されるよう特殊処理が施されています。また、塩分濃度の高い環境や濁った水中でも性能を発揮できるよう耐腐食性や視認性にも配慮しています。'
          },
          {
            question: '交換パーツやアフターサービスはありますか？',
            answer: 'はい、すべてのプロモデルには3年間の製品保証が付いており、素材の劣化や製造上の不具合には無償で対応しています。また、フィンのブレードやストラップ、マスクのスカート部分などの消耗パーツは単品でも購入可能です。修理や調整が必要な場合は、専門技術者による有償サービスもご利用いただけます。'
          }
        ];
      default: // beginner
        return [
          {
            question: '初心者でも使いこなせますか？',
            answer: '当サイトのスターターセットは、初めてスキンダイビングを行う方でも使いやすいように設計されています。特に簡単に調整できるストラップや呼吸しやすいスノーケルなど、初心者が陥りがちな問題点をクリアしています。また、詳しい使用方法のガイドブックも付属しているので安心です。'
          },
          {
            question: 'サイズ選びのコツは？',
            answer: 'マスクは顔の形に、フィンは足のサイズに合わせる必要があります。マスクは、鼻部分がしっかりとシールされるものを選び、吸い込むとマスクが顔に吸い付くタイプが理想的です。フィンは通常の靴のサイズより1サイズ小さめか同じサイズを選ぶことが多いですが、セット購入の際にはサイズ相談も承っています。'
          },
          {
            question: '購入後のメンテナンス方法は？',
            answer: '使用後は必ず真水でよくすすぎ、直射日光を避けて乾燥させてください。特にマスクのシリコン部分は紫外線に弱いため、保管時は暗所で保管することをお勧めします。また、長期間使用しない場合は、パーツを分解して保管すると劣化を防げます。シーズン開始前には、ストラップなどの消耗品のチェックも忘れずに行いましょう。'
          },
          {
            question: 'シュノーケリング用との違いは？',
            answer: 'スキンダイビングは水面だけでなく潜水することを前提としているため、装備にもいくつかの違いがあります。特にフィンはシュノーケリング用より長く硬めで推進力を重視しています。また、マスクは容積が小さく、耳抜きがしやすいよう鼻部分の設計が異なります。当サイトのセットはスキンダイビングに最適化された設計ですが、シュノーケリングにも使用可能です。'
          },
          {
            question: 'スキンダイビングを始めるのにこれだけで十分？',
            answer: '基本的にはマスク、スノーケル、フィンの3点セットがあれば始められます。水着は通常の水着で問題ありませんが、長時間の活動や水温が低い場所では、ウェットスーツがあると快適です。また、初心者の方は浮力を確保するためのライフジャケットや、足がつる場合に備えて塩分タブレットなども用意しておくと安心です。これらのオプションアイテムも当サイトでお求めいただけます。'
          }
        ];
    }
  };

  const faqs = getFAQs();

  return (
    <section className="faq" id="faq" ref={faqRef}>
      <div className="container">
        <div className="faq-header">
          <h2 className="faq-title">よくある質問</h2>
        </div>
        <div className="faq-list">
          {faqs.map((faq, index) => (
            <div
              key={index}
              className={`faq-item ${activeIndex === index ? 'active' : ''}`}
            >
              <div
                className="faq-question"
                onClick={() => toggleFAQ(index)}
              >
                <div className="faq-question-text">Q: {faq.question}</div>
                <div className="faq-toggle">+</div>
              </div>
              <div className="faq-answer">
                <div className="faq-answer-content">{faq.answer}</div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  );
};

export default FAQ;
